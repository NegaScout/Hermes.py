[Interface]
Address = {{ HOST.Address }}
{% if HOST.ListenPort | default(false) %}ListenPort = {{ HOST.ListenPort }}{%- endif %}
PrivateKey = {{ HOST.PrivateKey }}
{%- if HOST.DNS       | default(false)%}DNS = {{ HOST.DNS }}           {%- endif %}
{%- if HOST.Table     | default(false)%}Table = {{ HOST.Table }}       {%- endif %}
{%- if HOST.MTU       | default(false)%}MTU = {{ HOST.MTU }}           {%- endif %}
{%- if HOST.PreUp     | default(false)%}PreUp = {{ HOST.PreUp }}       {%- endif %}
{%- if HOST.PostUp    | default(false)%}PostUp = {{ HOST.PostUp }}     {%- endif %}
{%- if HOST.PreDown   | default(false)%}PreDown = {{ HOST.PreDown }}   {%- endif %}
{%- if HOST.PostDown  | default(false)%}PostDown = {{ HOST.PostDown }} {%- endif %}

{%- macro peer_entry(peer) %}

[Peer]
{% if peer.USER_NAME | default(false) %}#Name = {{ peer.USER_NAME }}/{{ peer.USER_ID }} {%- endif %}
Endpoint = {{ peer.Endpoint }}{% if HOST.ListenPort | default(false) %}:{{ HOST.ListenPort }} {%- endif %}
PublicKey = {{ peer.USER_WG_IP }}
AllowedIPs = {{ HOST.Address }}
{% if MISC.PersistentKeepalive | default(false) -%} PersistentKeepalive = {{ MISC.PersistentKeepalive }} {%- endif %}
{%- endmacro -%}

{%- for peer in PEERS -%}
{{ peer_entry(peer) }}
{%- endfor -%}
